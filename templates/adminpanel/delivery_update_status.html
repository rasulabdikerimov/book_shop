{% extends 'adminpanel/base.html' %}
{% block title %}Изменить статус доставки — Admin{% endblock %}
{% block header %}Изменить статус доставки для заказа #{{ delivery.order.order_number }}{% endblock %}
{% block content %}

<div class="panel">
    <div style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
        <h3 style="margin-top: 0; margin-bottom: 15px;">Информация о доставке</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 20px;">
            <div>
                <label style="display: block; font-weight: bold; margin-bottom: 5px;">Номер заказа</label>
                <p style="margin: 0; font-size: 18px; color: #0066cc;">#{{ delivery.order.order_number }}</p>
            </div>
            <div>
                <label style="display: block; font-weight: bold; margin-bottom: 5px;">Адрес доставки</label>
                <p style="margin: 0;">{{ delivery.delivery_address }}</p>
            </div>
            <div>
                <label style="display: block; font-weight: bold; margin-bottom: 5px;">Дата доставки</label>
                <p style="margin: 0;">{{ delivery.delivery_date|default:"Не указана" }}</p>
            </div>
            <div>
                <label style="display: block; font-weight: bold; margin-bottom: 5px;">Сотрудник доставки</label>
                <p style="margin: 0;">{{ delivery.employee.full_name|default:"Не назначен" }}</p>
            </div>
        </div>
    </div>

    <form method="POST" style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
        {% csrf_token %}
        
        <div style="margin-bottom: 20px;">
            <label for="status" style="display: block; font-weight: bold; margin-bottom: 8px;">Статус доставки</label>
            <select name="status" id="status" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;" required>
                <option value="">-- Выберите статус --</option>
                {% for status in statuses %}
                    <option value="{{ status }}" {% if delivery.status == status %}selected{% endif %}>{{ status }}</option>
                {% endfor %}
            </select>
            <small style="color: #666; margin-top: 5px; display: block;">
                <strong>Внимание:</strong> При изменении статуса на "Завершена" товар будет вычтен из наличия.
            </small>
        </div>

        <div style="display: flex; gap: 10px;">
            <button type="submit" class="btn">Сохранить</button>
            <a href="{% url 'adminpanel:order_detail' delivery.order.id %}" class="btn muted">← Отмена</a>
        </div>
    </form>
</div>

{% endblock %}
